<div class="container my-5">
  <div class="table-container shadow-sm rounded p-4">
    <h3 class="fw-bold text-primary mb-3 text-center">ğŸ¾ Lista de Mascotas</h3>

    <!-- IntroducciÃ³n -->
    <p class="text-muted text-center mb-4">
      En esta secciÃ³n puedes ver todas tus mascotas registradas, editar su informaciÃ³n o eliminarlas.
      MantÃ©n actualizados sus datos para llevar un mejor control de su salud y seguimiento ğŸ•ğŸ¦.
    </p>

    <!-- Mostrar card si no hay mascotas -->
    <div *ngIf="mascotas.length === 0" class="text-center py-5">
      <img src="https://cdn-icons-png.flaticon.com/512/616/616408.png" alt="Sin mascotas" width="100" class="mb-3">
      <h4 class="fw-bold text-muted">AÃºn no tienes mascotas registradas</h4>
    </div>

    <!-- Tabla cuando hay mascotas -->
    <div *ngIf="mascotas.length > 0" class="table-responsive">
      <table class="table table-hover align-middle text-center">
        <thead class="thead-custom">
          <tr>
            <th>ID</th>
            <th>Nombre</th>
            <th>Especie</th>
            <th>Edad</th>
            <th>Estado de Salud</th>
            <th>Internado</th>
            <th>Collar</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let mascota of mascotas">
            <!-- EdiciÃ³n -->
            <ng-container *ngIf="editMode[mascota.id!]; else viewRow">
              <td>{{ mascota.id }}</td>
              <td><input [(ngModel)]="mascotaEdit.nombre" class="form-control form-control-sm" placeholder="Nombre" />
              </td>
              <td><input [(ngModel)]="mascotaEdit.especie" class="form-control form-control-sm" placeholder="Especie" />
              </td>
              <td><input [(ngModel)]="mascotaEdit.edad" type="number" class="form-control form-control-sm text-center"
                  min="0" /></td>
              <td>
                <select [(ngModel)]="mascotaEdit.estadoSalud" class="form-select form-select-sm">
                  <option value="Estable">Estable</option>
                  <option value="Critico">CrÃ­tico</option>
                </select>
              </td>
              <td>
                <input type="checkbox" [(ngModel)]="mascotaEdit.internado" class="form-check-input"
                  style="width: 20px; height: 20px;">
              </td>
              <td>
                <select [(ngModel)]="mascotaEdit.collarAsignado" class="form-select form-select-sm">
                  <option [ngValue]="null">-- Sin collar --</option>
                  <option *ngFor="let c of collares" [ngValue]="c.id">
                    {{ c.codigo }} - {{ c.modelo }}
                  </option>
                </select>
              </td>
              <td>
                <div class="d-flex justify-content-center gap-2">
                  <button class="btn btn-success btn-sm px-3" (click)="guardarEdicion(mascota.id)">ğŸ’¾ Guardar</button>
                  <button class="btn btn-outline-secondary btn-sm px-3" (click)="cancelarEdicion(mascota.id)">âŒ
                    Cancelar</button>
                </div>
              </td>
            </ng-container>

            <!-- Vista normal -->
            <ng-template #viewRow>
              <td>{{ mascota.id }}</td>
              <td class="fw-bold">{{ mascota.nombre }}</td>
              <td>{{ mascota.especie }}</td>
              <td>{{ mascota.edad }}</td>
              <td>
                <span class="badge bg-success" *ngIf="mascota.estadoSalud === 'Estable'">Estable</span>
                <span class="badge bg-danger" *ngIf="mascota.estadoSalud === 'Critico'">CrÃ­tico</span>
              </td>
              <td>
                <span class="badge" [ngClass]="mascota.internado ? 'bg-info' : 'bg-secondary'">
                  {{ mascota.internado ? 'SÃ­' : 'No' }}
                </span>
              </td>
              <td>
                <span *ngIf="mascota.collarAsignado" class="badge bg-primary">
                  {{ mascota.collarAsignado.codigo }}
                </span>
                <span *ngIf="!mascota.collarAsignado" class="text-muted">Sin collar</span>
              </td>
              <td>
                <div class="d-flex justify-content-center gap-2">
                  <button class="btn btn-outline-primary btn-sm px-3" (click)="activarEdicion(mascota)">âœï¸
                    Editar</button>
                  <button class="btn btn-outline-danger btn-sm px-3" (click)="eliminarMascota(mascota.id)">ğŸ—‘ï¸
                    Eliminar</button>
                </div>
              </td>
            </ng-template>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>