<div class="container my-4">
  <h2 class="text-primary">ğŸ’Š Tratamientos</h2>
  <p class="text-muted text-center mb-4">
  En esta secciÃ³n podrÃ¡s <strong>registrar, consultar y dar seguimiento a los tratamientos mÃ©dicos</strong> de tus mascotas.  
  AquÃ­ se incluyen medicaciones, terapias, vacunas y cualquier procedimiento recomendado por el veterinario ğŸ¶ğŸ±ğŸ¦œ.  
  Llevar este control te ayudarÃ¡ a garantizar un cuidado constante y organizado.
</p>

  <!-- Mensaje si no hay tratamientos -->
  <p *ngIf="tratamientos.length === 0" class="text-danger">
    âš  No hay tratamientos registrados
  </p>

  <!-- Formulario para nuevo tratamiento -->
  <div class="card p-3 shadow-sm mb-4">
    <h5 class="fw-bold">â• Nuevo Tratamiento</h5>
    <form (ngSubmit)="guardar()">
      <div class="row g-2">
        <div class="col-md-2">
          <label class="form-label">ID Mascota</label>
          <input type="number" class="form-control" [(ngModel)]="nuevo.mascotaId" name="mascotaId" required>
        </div>
        <div class="col-md-2">
          <label class="form-label">Historial (opcional)</label>
          <input type="number" class="form-control" [(ngModel)]="nuevo.historialId" name="historialId">
        </div>
        <div class="col-md-4">
          <label class="form-label">Tratamiento</label>
          <input type="text" class="form-control" [(ngModel)]="nuevo.nombreTratamiento" name="nombreTratamiento" required>
        </div>
        <div class="col-md-4">
          <label class="form-label">Estado</label>
          <select class="form-select" [(ngModel)]="nuevo.estado" name="estado">
            <option>Activo</option>
            <option>Finalizado</option>
            <option>Suspendido</option>
          </select>
        </div>
        <div class="col-md-3">
          <label class="form-label">Inicio</label>
          <input type="date" class="form-control" [(ngModel)]="nuevo.fechaInicio" name="fechaInicio" required>
        </div>
        <div class="col-md-3">
          <label class="form-label">Fin</label>
          <input type="date" class="form-control" [(ngModel)]="nuevo.fechaFin" name="fechaFin">
        </div>
        <div class="col-12">
          <label class="form-label">DescripciÃ³n / Dosis</label>
          <textarea class="form-control" [(ngModel)]="nuevo.descripcion" name="descripcion"></textarea>
        </div>
      </div>
      <button class="btn btn-success mt-3">Guardar</button>
    </form>
  </div>

 <!-- Tabla de tratamientos -->
<h5 class="fw-bold">ğŸ“‹ Tratamientos Registrados</h5>
<table class="table table-hover shadow-sm" *ngIf="tratamientos.length > 0">
  <thead class="table-light">
    <tr>
      <th>ID</th>
      <th>Mascota</th>
      <th>Tratamiento</th>
      <th>DescripciÃ³n</th> 
      <th>Estado</th>
      <th>Inicio</th>
      <th>Fin</th>
      <th>Acciones</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let t of tratamientos">
      <td>{{ t.id }}</td>
      <td>{{ t.nombreMascota || ('#' + t.mascotaId) }}</td>
      <td>{{ t.nombreTratamiento }}</td>
      
      <!-- DescripciÃ³n con Ã­cono -->
      <td>
        <span *ngIf="t.descripcion; else sinDesc">
          ğŸ“„ {{ t.descripcion }}
        </span>
        <ng-template #sinDesc>
          <span class="text-muted">â€”</span>
        </ng-template>
      </td>
      
      <td>
        <!-- Badge dinÃ¡mico para cualquier estado -->
        <span [ngClass]="{
            'badge bg-success': t.estado==='Activo',
            'badge bg-danger': t.estado==='Finalizado',
            'badge bg-warning text-dark': t.estado==='Suspendido',
            'badge bg-info text-dark': t.estado==='Estable',
            'badge bg-secondary': t.estado!=='Activo' && t.estado!=='Finalizado' && t.estado!=='Suspendido' && t.estado!=='Estable'
        }">
          {{ t.estado }}
        </span>
      </td>
      <td>{{ t.fechaInicio }}</td>
      <td>{{ t.fechaFin || '-' }}</td>
      <td>
        <button class="btn btn-outline-primary btn-sm me-1" (click)="suspender(t)" [disabled]="t.estado!=='Activo'">Suspender</button>
        <button class="btn btn-outline-success btn-sm me-1" (click)="finalizar(t)" [disabled]="t.estado!=='Activo'">Finalizar</button>
        <button class="btn btn-outline-danger btn-sm" (click)="eliminar(t)">Eliminar</button>
      </td>
    </tr>
  </tbody>
</table>
</div>